{
  "@id": "/devops/caching",
  "@type": "Document",
  "UID": "2677301a056747de866f4488e7e4c047",
  "allow_discussion": null,
  "blocks": {
    "06429da1-e8b2-4346-95f3-f7c97d20743d": {
      "@type": "codeBlock",
      "code": "'RespStatus >= 400'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "0c46d373-be12-4939-9fcc-49b384cf11bb": {
      "@type": "slate",
      "plaintext": "List backend request that download a file",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List backend request that download a file"
            }
          ],
          "type": "p"
        }
      ]
    },
    "1f171355-a775-4ef6-9ec5-4428deb28e08": {
      "@type": "slate",
      "plaintext": "Ferramentas",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "Ferramentas"
            }
          ],
          "type": "h2"
        }
      ]
    },
    "2249d0e6-7296-4c33-b160-73722ee3739d": {
      "@type": "codeBlock",
      "code": "'ReqMethod eq \"PURGE\"'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "25eeca98-1021-4480-a801-d839bec00f63": {
      "@type": "slate",
      "plaintext": "The following filters can be used with any of\u00a0Varnish\u00a0tools (varnishlog, varnishncsa, varnishhist) by passing them after the \"-q\" option:",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "The following filters can be used with any of\u00a0Varnish\u00a0tools (varnishlog, varnishncsa, varnishhist) by passing them after the \"-q\" option:"
            }
          ],
          "type": "p"
        }
      ]
    },
    "29415865-4f90-4e1d-857d-45ba11c0691f": {
      "@type": "slate",
      "plaintext": "List requests with a status code 404",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List requests with a status code 404"
            }
          ],
          "type": "p"
        }
      ]
    },
    "2f35e890-435f-4286-998b-6f65fea69704": {
      "@type": "slate",
      "plaintext": "Debug",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "Debug"
            }
          ],
          "type": "h2"
        }
      ]
    },
    "32596ac9-189f-4a55-8e7f-5c2546bbf2ef": {
      "@type": "description"
    },
    "3c9e7298-9be8-4247-a7b1-f47021bf3e94": {
      "@type": "slate",
      "plaintext": "List backend requests to a given url (i.e. /de)",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List backend requests to a given url (i.e. /de)"
            }
          ],
          "type": "p"
        }
      ]
    },
    "4ef3fe47-1c84-4b44-849b-c79fe44231a6": {
      "@type": "codeBlock",
      "code": "'ReqURL eq \"/de\"'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "5a93bed3-2a4b-4d38-a48a-a2b2cf9fb1f4": {
      "@type": "slate",
      "plaintext": "List requests with any error code bigger than 404",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List requests with any error code bigger than 404"
            }
          ],
          "type": "p"
        }
      ]
    },
    "61a73651-9f5c-4803-8e80-28b24bf217c4": {
      "@type": "codeBlock",
      "code": "'BereqURL ~ \"@@download/file\"'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "64225efe-dddc-4ed6-90e5-27b657d35884": {
      "@type": "slate",
      "plaintext": "List incoming PURGE requests",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List incoming PURGE requests"
            }
          ],
          "type": "p"
        }
      ]
    },
    "7072a689-43bd-4fce-a106-925f56424545": {
      "@type": "slateTable",
      "styles": {},
      "table": {
        "basic": false,
        "celled": true,
        "compact": false,
        "fixed": true,
        "hideHeaders": false,
        "inverted": false,
        "rows": [
          {
            "cells": [
              {
                "key": "6l3fo",
                "type": "header",
                "value": [
                  {
                    "children": [
                      {
                        "text": "Ferramenta"
                      }
                    ],
                    "type": "p"
                  }
                ]
              },
              {
                "key": "b09l0",
                "type": "header",
                "value": [
                  {
                    "children": [
                      {
                        "text": "Uso"
                      }
                    ],
                    "type": "p"
                  }
                ]
              }
            ],
            "key": "8ki1u"
          },
          {
            "cells": [
              {
                "key": "c8bam",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "varnishlog"
                      }
                    ],
                    "type": "p"
                  }
                ]
              },
              {
                "key": "eb3de",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "Logs to debug Varnish inner working"
                      }
                    ],
                    "type": "p"
                  }
                ]
              }
            ],
            "key": "37ssb"
          },
          {
            "cells": [
              {
                "key": "26t0q",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "varnishncsa"
                      }
                    ],
                    "type": "p"
                  }
                ]
              },
              {
                "key": "avqaf",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "Access logs"
                      }
                    ],
                    "type": "p"
                  }
                ]
              }
            ],
            "key": "67rlj"
          },
          {
            "cells": [
              {
                "key": "4997c",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "varnishhist"
                      }
                    ],
                    "type": "p"
                  }
                ]
              },
              {
                "key": "19nmj",
                "type": "data",
                "value": [
                  {
                    "children": [
                      {
                        "text": "Histogram displaying time to serve a request"
                      }
                    ],
                    "type": "p"
                  }
                ]
              }
            ],
            "key": "9e1h4"
          }
        ],
        "striped": false
      }
    },
    "894f980e-493e-4fbf-ac73-5fbe63217d0a": {
      "@type": "slate",
      "plaintext": "Filters (VSL)",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "Filters (VSL)"
            }
          ],
          "type": "h2"
        }
      ]
    },
    "98a91bf1-fd2a-42cf-b6e3-08d189c3cbe6": {
      "@type": "slate",
      "plaintext": "Fluxo",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "Fluxo"
            }
          ],
          "type": "h2"
        }
      ]
    },
    "ae2ac97c-b87e-47f1-9cba-089393393903": {
      "@type": "codeBlock",
      "code": "varnishncsa -q 'ReqURL eq \"/de\"'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "ccf2e391-8e41-4fc9-9da4-4d2ad11ad860": {
      "@type": "codeBlock",
      "code": "'BereqURL eq \"/de\"'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "cdb6988c-0aec-4114-a80a-dfb6f3f65317": {
      "@type": "codeBlock",
      "code": "'RespStatus == 404'",
      "language": "bash",
      "lineNbr": 1,
      "showLineNumbers": false,
      "style": "light",
      "wrapLongLines": false
    },
    "d58557c7-ba60-4eaa-8f66-c0df32f38f08": {
      "@type": "slate",
      "plaintext": "List client requests to a given url (i.e. /de)",
      "styles": {},
      "value": [
        {
          "children": [
            {
              "text": "List client requests to a given url (i.e. /de)"
            }
          ],
          "type": "p"
        }
      ]
    },
    "ed53c519-05de-411f-b654-47cb7161895a": {
      "@type": "mermaidBlock",
      "code": "---\ntitle: Flow for first request to a site homepage\n---\nsequenceDiagram\n    autonumber\n    actor user as User\n    participant traefik as Traekif<br>Router\n    participant varnish as Varnish<br>Caching\n    participant express as Express<br>Volto SSR\n    participant plone as Backend<br>Plone API\n    user->>+traefik: GET /\n    traefik->>+varnish: GET /\n    varnish->>+traefik: GET /<br>Header: X-Varnish-Routed=1\n    traefik->>+express: GET /<br>Header: X-Varnish-Routed=1\n    express->>+plone: GET /++api++/\n    plone-->>-express: Response application/json\n    express-->>-traefik: Response text/html\n    traefik-->>-varnish: Response text/html\n    varnish-->>-traefik: Response text/html<br>After storing response in cache\n    traefik-->>-user: Response text/html"
    },
    "f521545d-75c0-4d71-a357-6a22fb060c8c": {
      "@type": "title"
    }
  },
  "blocks_layout": {
    "items": [
      "f521545d-75c0-4d71-a357-6a22fb060c8c",
      "32596ac9-189f-4a55-8e7f-5c2546bbf2ef",
      "98a91bf1-fd2a-42cf-b6e3-08d189c3cbe6",
      "ed53c519-05de-411f-b654-47cb7161895a",
      "2f35e890-435f-4286-998b-6f65fea69704",
      "1f171355-a775-4ef6-9ec5-4428deb28e08",
      "7072a689-43bd-4fce-a106-925f56424545",
      "894f980e-493e-4fbf-ac73-5fbe63217d0a",
      "25eeca98-1021-4480-a801-d839bec00f63",
      "ae2ac97c-b87e-47f1-9cba-089393393903",
      "64225efe-dddc-4ed6-90e5-27b657d35884",
      "2249d0e6-7296-4c33-b160-73722ee3739d",
      "d58557c7-ba60-4eaa-8f66-c0df32f38f08",
      "4ef3fe47-1c84-4b44-849b-c79fe44231a6",
      "3c9e7298-9be8-4247-a7b1-f47021bf3e94",
      "ccf2e391-8e41-4fc9-9da4-4d2ad11ad860",
      "0c46d373-be12-4939-9fcc-49b384cf11bb",
      "61a73651-9f5c-4803-8e80-28b24bf217c4",
      "29415865-4f90-4e1d-857d-45ba11c0691f",
      "cdb6988c-0aec-4114-a80a-dfb6f3f65317",
      "5a93bed3-2a4b-4d38-a48a-a2b2cf9fb1f4",
      "06429da1-e8b2-4346-95f3-f7c97d20743d"
    ]
  },
  "contributors": [],
  "created": "2024-12-11T19:08:29+00:00",
  "creators": [
    "b8b97d5f-26aa-4289-beaf-ab8a4696e887"
  ],
  "description": "Informa\u00e7\u00f5es sobre caching com Varnish",
  "effective": null,
  "exclude_from_nav": false,
  "expires": null,
  "exportimport.constrains": {},
  "exportimport.conversation": [],
  "exportimport.versions": {},
  "id": "caching",
  "is_folderish": true,
  "language": "##DEFAULT##",
  "layout": "document_view",
  "lock": {
    "locked": false,
    "stealable": true
  },
  "modified": "2024-12-11T19:14:07+00:00",
  "parent": {
    "@id": "/devops",
    "@type": "Document",
    "Subject": [],
    "UID": "e28365bb521b46819adb7cad1f8b3226",
    "description": "A maior parte das atividades de devops s\u00e3o realizadas utilizando playbooks Ansible.",
    "effective": "1969-12-31T03:00:00+00:00",
    "image_field": null,
    "image_scales": {
      "preview_image": [
        {
          "content-type": "image/jpeg",
          "download": "@@images/preview_image-1000-433763c67c1f1fb6156a3a78827557f5.jpeg",
          "filename": "devops.jpeg",
          "height": 1000,
          "scales": {
            "icon": {
              "download": "@@images/preview_image-32-7d252db097f5b8f12f0f0a59ced1e4e1.jpeg",
              "height": 32,
              "width": 32
            },
            "large": {
              "download": "@@images/preview_image-800-5ff3c0fbb6a2ad68510a593db6cf9e32.jpeg",
              "height": 800,
              "width": 800
            },
            "larger": {
              "download": "@@images/preview_image-1000-1861145b8464d66254a6bc3d16066a40.jpeg",
              "height": 1000,
              "width": 1000
            },
            "mini": {
              "download": "@@images/preview_image-200-76da73987fb1cdd66bd525170ab62081.jpeg",
              "height": 200,
              "width": 200
            },
            "preview": {
              "download": "@@images/preview_image-400-a6a6648ffc9188eadbd4359973483ac3.jpeg",
              "height": 400,
              "width": 400
            },
            "teaser": {
              "download": "@@images/preview_image-600-96c67ba9b144fc5faaa74bd36a49e0de.jpeg",
              "height": 600,
              "width": 600
            },
            "thumb": {
              "download": "@@images/preview_image-128-aaa9df74f1f46c1505f22e407f18c4b8.jpeg",
              "height": 128,
              "width": 128
            },
            "tile": {
              "download": "@@images/preview_image-64-2260770388652cbb0e6b1756a0100a52.jpeg",
              "height": 64,
              "width": 64
            }
          },
          "size": 103142,
          "width": 1000
        }
      ]
    },
    "review_state": "private",
    "title": "DevOps",
    "type_title": "Page"
  },
  "preview_caption": null,
  "preview_image": {
    "blob_path": "2677301a056747de866f4488e7e4c047/preview_image/varnish.png",
    "content-type": "image/png",
    "filename": "varnish.png",
    "height": 142,
    "size": 8521,
    "width": 200
  },
  "review_state": "private",
  "rights": "",
  "subjects": [],
  "title": "Caching",
  "type_title": "Page",
  "version": "current",
  "workflow_history": {
    "simple_publication_workflow": [
      {
        "action": null,
        "actor": "b8b97d5f-26aa-4289-beaf-ab8a4696e887",
        "comments": "",
        "review_state": "private",
        "time": "2024-12-11T19:08:29+00:00"
      }
    ]
  },
  "working_copy": null,
  "working_copy_of": null
}
